# Containerfile
FROM node:18-alpine

WORKDIR /app

# Install deps (dev deps included so Stylus can build)
COPY package*.json ./
RUN npm ci

# Copy the rest
COPY . .

# Build Stylus -> CSS if present (wonâ€™t fail if missing)
RUN [ -f src/styles/main.styl ] && npx stylus src/styles/main.styl -o public/css || true

# Trim dev deps for runtime
RUN npm prune --production

ENV NODE_ENV=production
ENV PORT=3000
EXPOSE 3000

CMD ["node", "app.js"]


